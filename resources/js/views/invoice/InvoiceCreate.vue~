<template>
    <div class="container-fluid">
        <breadcrumb :options="['Invoice Create']">
            <router-link :to="{name: 'InvoiceList'}" class="btn btn-primary btn-sm">Back</router-link>
        </breadcrumb>
        <div class="row">
            <div class="col-sm-12">
                <div class="card">
                    <div class="datatable" v-if="!isLoading">
                        <div class="card-body" id="customer_form">
                            <ValidationObserver v-slot="{ handleSubmit }">
                                <form @submit.prevent="handleSubmit(onSubmit)">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="row form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 160px">Bike Details</p>
                                                </div>
                                                <div class="col-12 col-md-3">
                                                    <ValidationProvider name="ChassisNo" mode="eager" rules="required"
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Chassis No<span style="color: red">*</span></label>
                                                            <multiselect v-model="form.ChassisNo"
                                                                         :options="AllChassisNo"
                                                                         data-index="1"
                                                                         :multiple="false"
                                                                         @search-change="filterChassisNo"
                                                                         @input="doCheckChassisNo"
                                                                         :close-on-select="true"
                                                                         :clear-on-select="false"
                                                                         :preserve-search="true"
                                                                         placeholder="Chassis No"
                                                                         label="chassisno" track-by="chassisno">

                                                            </multiselect>
                                                            <!--                              <input type="text" class="form-control" name="ChassisNo" v-model="form.ChassisNo" @change="doCheckChassisNo">-->
                                                            <!--                              <div class="error" v-if="form.errors.has('ChassisNo')" v-html="form.errors.get('ChassisNo')" />-->
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="EngineNo" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Engine No.</label>
                                                            <input type="text" class="form-control" readonly
                                                                   name="EngineNo" v-model="form.EngineNo">
                                                            <div class="error" v-if="form.errors.has('EngineNo')"
                                                                 v-html="form.errors.get('EngineNo')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="ProductCode" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Product Code.</label>
                                                            <input type="text" class="form-control" readonly
                                                                   name="ProductCode" v-model="form.ProductCode">
                                                            <div class="error" v-if="form.errors.has('ProductCode')"
                                                                 v-html="form.errors.get('ProductCode')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="Model" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Model.</label>
                                                            <input type="text" class="form-control" readonly
                                                                   name="Model" v-model="form.Model">
                                                            <div class="error" v-if="form.errors.has('Model')"
                                                                 v-html="form.errors.get('Model')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="Color" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Color.</label>
                                                            <input type="text" class="form-control" readonly
                                                                   name="Color" v-model="form.Color">
                                                            <div class="error" v-if="form.errors.has('Color')"
                                                                 v-html="form.errors.get('Color')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="Price" mode="eager" rules="required"
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Price <span style="color: red">*</span></label>
                                                            <input type="text" class="form-control" readonly
                                                                   name="Price" v-model="form.Price">
                                                            <div class="error" v-if="form.errors.has('Price')"
                                                                 v-html="form.errors.get('Price')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="Discount" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Discount</label>
                                                            <input type="number" class="form-control" name="Discount"
                                                                   v-model="form.Discount" @change="setDiscount">
                                                            <div class="error" v-if="form.errors.has('Discount')"
                                                                 v-html="form.errors.get('Discount')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="SalesType" mode="eager" rules="required"
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Sales Type <span style="color: red">*</span></label>
                                                            <select name="SalesType" class="form-control"
                                                                    v-model="form.SalesType" @change="changeSalesType">
                                                                <option value="cash">Cash</option>
                                                                <option value="credit">Credit</option>
                                                                <option value="exchange">Exchange</option>
                                                                <option value="test_ride">Test Ride</option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('SalesType')"
                                                                 v-html="form.errors.get('SalesType')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="CreditFieldEnable">
                                                    <ValidationProvider name="CreditAmount" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Credit Amount.</label>
                                                            <input type="number" class="form-control"
                                                                   name="CreditAmount" v-model="form.CreditAmount">
                                                            <div class="error" v-if="form.errors.has('CreditAmount')"
                                                                 v-html="form.errors.get('CreditAmount')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="CreditFieldEnable">
                                                    <ValidationProvider name="Tenure" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Tenure.</label>
                                                            <input type="number" class="form-control" name="Tenure"
                                                                   v-model="form.Tenure">
                                                            <div class="error" v-if="form.errors.has('Tenure')"
                                                                 v-html="form.errors.get('Tenure')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 200px">Customer Details</p>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-5">
                                                        <ValidationProvider name="CustomerName" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Customer
                                                                    Name<span style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <input name="CustomerName" type="text"
                                                                           class="form-control"
                                                                           v-model="form.CustomerName"/>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('CustomerName')"
                                                                         v-html="form.errors.get('CustomerName')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="Gender" mode="eager" rules="required"
                                                                            v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Gender<span
                                                                        style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <select name="Gender" class="form-control"
                                                                            v-model="form.Gender" style="margin: 0">
                                                                        <option value="Male">Male</option>
                                                                        <option value="Female">Female</option>
                                                                        <option value="Other">Other</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="FatherName" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Father/Husband
                                                                    Name<span style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <input name="FatherName" type="text"
                                                                           class="form-control"
                                                                           v-model="form.FatherName"/>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('FatherName')"
                                                                         v-html="form.errors.get('FatherName')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="Address" mode="eager" rules="required"
                                                                            v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Address<span
                                                                        style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <input name="Address" type="text"
                                                                           class="form-control" v-model="form.Address"/>
                                                                    <div class="error" v-if="form.errors.has('Address')"
                                                                         v-html="form.errors.get('Address')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <label class="col-lg-4 col-form-label text-right">Permanent
                                                                Address</label>
                                                            <div class="col-lg-8">
                                                                <input name="permanentAddress" type="text"
                                                                       class="form-control"
                                                                       v-model="form.PermanentAddress"/>
                                                                <div class="error" v-if="form.errors.has('Address')"
                                                                     v-html="form.errors.get('Address')"/>
                                                                <span class="error-message"> {{ errors[0] }}</span>
                                                            </div>
                                                        </div>
                                                        <ValidationProvider name="DistrictCode" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">District<span
                                                                        style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <select name="DistrictCode" class="form-control"
                                                                            v-model="form.DistrictCode"
                                                                            style="margin: 0"
                                                                            @change="districtWiseThana">
                                                                        <option :value="district.DistrictCode"
                                                                                v-for="(district , index) in districts"
                                                                                :key="index">{{ district.DistrictName }}
                                                                        </option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('District')"
                                                                         v-html="form.errors.get('District')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="Email" mode="eager" rules=""
                                                                            v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Email</label>
                                                                <div class="col-lg-8">
                                                                    <input name="Email" type="text" class="form-control"
                                                                           v-model="form.Email"/>
                                                                    <div class="error" v-if="form.errors.has('Email')"
                                                                         v-html="form.errors.get('Email')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="InquirySale" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Inquiry
                                                                    Sale?<span style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <select name="InquirySale" class="form-control"
                                                                            v-model="form.InquirySale"
                                                                            style="margin: 0">
                                                                        <option value="1">Yes</option>
                                                                        <option value="0">No</option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('InquirySale')"
                                                                         v-html="form.errors.get('InquirySale')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="IFADisKnown" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Do you
                                                                    ever participate Royal Enfield Ride ?<span
                                                                            style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <select name="IFADisKnown" class="form-control"
                                                                            v-model="form.REisKnown" style="margin: 0">
                                                                        <option value="yes">Yes</option>
                                                                        <option value="no">No</option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('REisKnown')"
                                                                         v-html="form.errors.get('REisKnown')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="DateOfBirth" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-4 col-form-label text-right">Date
                                                                    of Birth (yyyy-mm-dd)<span
                                                                            style="color: red">*</span></label>
                                                                <div class="col-lg-8">
                                                                    <date-picker v-model="form.DateOfBirth"
                                                                                 valueType="format"></date-picker>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('DateOfBirth')"
                                                                         v-html="form.errors.get('DateOfBirth')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                    </div>

                                                    <div class="col-md-7">
                                                        <ValidationProvider name="CustomerOccupation" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Customer
                                                                    Occupation<span style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <select name="CustomerOccupation"
                                                                            class="form-control"
                                                                            v-model="form.CustomerOccupation"
                                                                            style="margin: 0">
                                                                        <option :value="occupation.OccupationId"
                                                                                v-for="(occupation , index) in occupations"
                                                                                :key="index">
                                                                            {{ occupation.OccupationName }}
                                                                        </option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('CustomerOccupation')"
                                                                         v-html="form.errors.get('CustomerOccupation')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="OwnerTyp" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Owner
                                                                    Typ<span style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <select name="OwnerTyp" class="form-control"
                                                                            v-model="form.OwnerTyp" style="margin: 0">
                                                                        <option value="Private">Private</option>
                                                                        <option value="Private Organization">Private
                                                                            Organization
                                                                        </option>
                                                                        <option value="Govt. Department">Govt.
                                                                            Department
                                                                        </option>
                                                                        <option value="Others">Others</option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('OwnerTyp')"
                                                                         v-html="form.errors.get('OwnerTyp')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="MotherName" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Mother
                                                                    Name<span style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <input name="MotherName" type="text"
                                                                           class="form-control"
                                                                           v-model="form.MotherName"/>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('MotherName')"
                                                                         v-html="form.errors.get('MotherName')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="Mobile" mode="eager" rules="required"
                                                                            v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Mobile<span
                                                                        style="color: red">*</span></label>
                                                                <div class="col-lg-5"
                                                                     style="display: flex;align-items: center;overflow: hidden">
                                                                    <span style=" background-color: #f7f7f7;font-size: 14px;padding: 0 8px;">+88</span>
                                                                    <input
                                                                            name="Mobile"
                                                                            type="tel"
                                                                            pattern="(01)?[0-9]{11}"
                                                                            class="form-control"
                                                                            v-model="form.Mobile"
                                                                            placeholder="Enter your mobile number"
                                                                    />
                                                                </div>

                                                                <div class="error" v-if="form.errors.has('Mobile')"
                                                                     v-html="form.errors.get('Mobile')"/>
                                                                <span class="error-message"> {{ errors[0] }}</span>
                                                            </div>
                                                        </ValidationProvider>
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <label class="col-lg-7 col-form-label text-right">Emergency
                                                                Mobile</label>
                                                            <div class="col-lg-5"
                                                                 style="display: flex;align-items: center;overflow: hidden">
                                                                <span style=" background-color: #f7f7f7;font-size: 14px;padding: 0 8px;">+88</span>
                                                                <input
                                                                        name="EmergencyMobile"
                                                                        type="tel"
                                                                        pattern="(01)?[0-9]{11}"
                                                                        class="form-control"
                                                                        v-model="form.EmergencyMobile"
                                                                        placeholder="Enter your mobile number"
                                                                />
                                                            </div>
                                                        </div>
                                                        <ValidationProvider name="ThanaCode" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Upazilla/Thana<span
                                                                        style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <select name="ThanaCode" class="form-control"
                                                                            v-model="form.ThanaCode " style="margin: 0">
                                                                        <option :value="thana.UpazillaCode"
                                                                                v-for="(thana , index) in thanas"
                                                                                :key="index">{{ thana.UpazillaName }}
                                                                        </option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('ThanaCode')"
                                                                         v-html="form.errors.get('ThanaCode')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="NID" mode="eager" rules=""
                                                                            v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">N.I.D/Passport
                                                                    No./Birth Certificate/Driving License<span
                                                                            style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <input name="NID" type="text" class="form-control"
                                                                           v-model="form.NID"/>
                                                                    <div class="error" v-if="form.errors.has('NID')"
                                                                         v-html="form.errors.get('NID')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <label class="col-lg-7 col-form-label text-right">Photo</label>
                                                            <div class="col-lg-5 text-left">
                                                                <input @change="changeImage($event)" type="file"
                                                                       name="Photo" class="form-control"
                                                                       :class="{ 'is-invalid': form.errors.has('Photo') }">
                                                                <img v-if="form.Photo" :src="showImage(form.Photo)"
                                                                     alt="" height="40px" width="40px">
                                                                <div class="error" v-if="form.errors.has('Photo')"
                                                                     v-html="form.errors.get('Photo')"/>
                                                            </div>
                                                        </div>
                                                        <ValidationProvider name="MonthlyIncome" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Monthly
                                                                    Income<span style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <select name="MonthlyIncome" class="form-control"
                                                                            v-model="form.MonthlyIncome"
                                                                            style="margin: 0">
                                                                        <option :value="income.IncomeId"
                                                                                v-for="(income , index) in monthly_income"
                                                                                :key="index">{{ income.Income }}
                                                                        </option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('OwnerTyp')"
                                                                         v-html="form.errors.get('OwnerTyp')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="ProductIntroducingMedia" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">How
                                                                    did you come to know about this model of Royal
                                                                    Enfield?<span style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <multiselect
                                                                            v-model="form.ProductIntroducingMedia"
                                                                            :options="productIntroducingMedias"
                                                                            :multiple="true"
                                                                            :searchable="true"
                                                                            :close-on-select="true"
                                                                            :show-labels="true"
                                                                            label="Media"
                                                                            track-by="Media"
                                                                            placeholder="Pick a value"></multiselect>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('ProductIntroducingMedia')"
                                                                         v-html="form.errors.get('ProductIntroducingMedia')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="interestInProduct" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Which
                                                                    features of this model of Royal Enfield made you
                                                                    interested in this product?<span style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <multiselect
                                                                            v-model="form.interestInProduct"
                                                                            :options="interestInProduct"
                                                                            :multiple="true"
                                                                            :searchable="true"
                                                                            :close-on-select="true"
                                                                            :show-labels="true"
                                                                            label="InterestInProduct"
                                                                            track-by="InterestInProduct"
                                                                            placeholder="Pick a value"></multiselect>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('interestInProduct')"
                                                                         v-html="form.errors.get('interestInProduct')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="previouslyUsedBike" mode="eager"
                                                                            rules="required" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">If you
                                                                    did own any two wheelers previously or do now, what
                                                                    is the brand of the bike?<span
                                                                            style="color: red">*</span></label>
                                                                <div class="col-lg-5 text-left">
                                                                    <multiselect
                                                                            v-model="form.previouslyUsedBike"
                                                                            :options="previouslyUsedBike"
                                                                            :multiple="true"
                                                                            :searchable="true"
                                                                            :close-on-select="true"
                                                                            :show-labels="true"
                                                                            label="BikeName"
                                                                            track-by="BikeName"
                                                                            placeholder="Pick a value"></multiselect>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('previouslyUsedBike')"
                                                                         v-html="form.errors.get('previouslyUsedBike')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <!--                            <ValidationProvider name="previousBikeCC" mode="eager" rules="" v-slot="{ errors }">-->
                                                        <!--                              <div class="form-group row" style="padding-bottom: 10px">-->
                                                        <!--                                <label class="col-lg-7 col-form-label text-right">What is your Previous Bike CC</label>-->
                                                        <!--                                <div class="col-lg-5 text-left">-->
                                                        <!--                                  <select name="previousBikeCC" class="form-control" v-model="form.previousBikeCC" style="margin: 0">-->
                                                        <!--                                    <option :value="cc.BikeCC" v-for="(cc , index) in previousBikeCC" :key="index">{{ cc.BikeCCDetails }}</option>-->
                                                        <!--                                  </select>-->
                                                        <!--                                  <div class="error" v-if="form.errors.has('previousBikeCC')" v-html="form.errors.get('previousBikeCC')" />-->
                                                        <!--                                  <span class="error-message"> {{ errors[0] }}</span>-->
                                                        <!--                                </div>-->
                                                        <!--                              </div>-->
                                                        <!--                            </ValidationProvider>-->
                                                        <ValidationProvider name="previousBikeUsage" mode="eager"
                                                                            rules="" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">What
                                                                    did you do with the previous bike?</label>
                                                                <div class="col-lg-5 text-left">
                                                                    <select name="previousBikeUsage"
                                                                            class="form-control"
                                                                            v-model="form.previousBikeUsage"
                                                                            style="margin: 0">
                                                                        <option :value="use.BikeUsage"
                                                                                v-for="(use , index) in previousBikeUsage"
                                                                                :key="index">{{ use.BikeUsageDetails }}
                                                                        </option>
                                                                    </select>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('previousBikeUsage')"
                                                                         v-html="form.errors.get('previousBikeUsage')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <ValidationProvider name="causeForBuyingNewBike" mode="eager"
                                                                            rules="" v-slot="{ errors }">
                                                            <div class="form-group row" style="padding-bottom: 10px">
                                                                <label class="col-lg-7 col-form-label text-right">Why
                                                                    are you buying the new bike?</label>
                                                                <div class="col-lg-5 text-left">
                                                                    <multiselect
                                                                            v-model="form.causeForBuyingNewBike"
                                                                            :options="causeForBuyingNewBike"
                                                                            :multiple="true"
                                                                            :searchable="true"
                                                                            :close-on-select="true"
                                                                            :show-labels="true"
                                                                            label="Cause"
                                                                            track-by="Cause"
                                                                            placeholder="Pick a value"></multiselect>
                                                                    <div class="error"
                                                                         v-if="form.errors.has('causeForBuyingNewBike')"
                                                                         v-html="form.errors.get('causeForBuyingNewBike')"/>
                                                                    <span class="error-message"> {{ errors[0] }}</span>
                                                                </div>
                                                            </div>
                                                        </ValidationProvider>
                                                        <!--                            <ValidationProvider name="wantJoinRE" mode="eager" rules="required" v-slot="{ errors }">-->
                                                        <!--                              <div class="form-group row" style="padding-bottom: 10px">-->
                                                        <!--                                <label class="col-lg-7 col-form-label text-right">Will you join Royal Enfield Club<span style="color: red">*</span>.</label>-->
                                                        <!--                                <div class="col-lg-5 text-left">-->
                                                        <!--                                  <select name="wantJoinRE" class="form-control" v-model="form.wantJoinRE" style="margin: 0">-->
                                                        <!--                                    <option value="Present Member">Present Member</option>-->
                                                        <!--                                    <option value="yes">Yes</option>-->
                                                        <!--                                    <option value="no">No</option>-->
                                                        <!--                                  </select>-->
                                                        <!--                                  <div class="error" v-if="form.errors.has('wantJoinRE')" v-html="form.errors.get('wantJoinRE')" />-->
                                                        <!--                                  <span class="error-message"> {{ errors[0] }}</span>-->
                                                        <!--                                </div>-->
                                                        <!--                              </div>-->
                                                        <!--                            </ValidationProvider>-->
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <label class="col-lg-7 col-form-label text-right">Blood Group</label>
                                                            <div class="col-lg-5 text-left">
                                                                <select

                                                                    id="blood-group"
                                                                    class="form-control"
                                                                    v-model="form.bloodGroup"
                                                                >
                                                                    <option disabled value="">-- Select Blood Group --</option>
                                                                    <option v-for="group in bloodGroups" :key="group" :value="group">
                                                                        {{ group }}
                                                                    </option>
                                                                </select>
                                                            </div>

                                                        </div>
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <label class="col-lg-7 col-form-label text-right">Marriage Day</label>
                                                            <div class="col-lg-5 text-left">
                                                                <date-picker v-model="form.MarriageDay"
                                                                             valueType="format"></date-picker>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    <br>

                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="row form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 160px">EMI Details</p>
                                                </div>

                                                <div class="col-6 col-md-4">
                                                    <ValidationProvider name="IsEmi" mode="eager" rules="required"
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>EMI?</label>
                                                            <select name="IsEmi" class="form-control"
                                                                    v-model="form.IsEmi" @change="changeIsEmi">
                                                                <option value="0">No</option>
                                                                <option value="1">Yes</option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('IsEmi')"
                                                                 v-html="form.errors.get('IsEmi')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4" v-if="IsEmiEnable">
                                                    <ValidationProvider name="InstallmentSize" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Installment Size (If Yes)</label>
                                                            <select name="InstallmentSize" class="form-control"
                                                                    v-model="form.InstallmentSize " style="margin: 0"
                                                                    @change="calculatePayableInterest">
                                                                <option :value="emi.installmentsize"
                                                                        v-for="(emi , index) in emi_installment"
                                                                        :key="index">{{ emi.installmentsize }}
                                                                </option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('InstallmentSize')"
                                                                 v-html="form.errors.get('InstallmentSize')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4" v-if="IsEmiEnable">
                                                    <ValidationProvider name="EmiBank" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>EMI Bank*</label>
                                                            <select name="EmiBank" class="form-control"
                                                                    v-model="form.EmiBank " style="margin: 0"
                                                                    @change="calculatePayableInterest">
                                                                <option :value="bank.emibankid"
                                                                        v-for="(bank , index) in emi_bank" :key="index">
                                                                    {{ bank.emibankname }}
                                                                </option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('EmiBank')"
                                                                 v-html="form.errors.get('EmiBank')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4" v-if="IsEmiEnable">
                                                    <ValidationProvider name="EmiAmount" mode="eager" rules="required"
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>EMI Amount*</label>
                                                            <input type="number" class="form-control" name="EmiAmount"
                                                                   v-model="form.EmiAmount"
                                                                   @keyup="calculatePayableInterest">
                                                            <div class="error" v-if="form.errors.has('EmiAmount')"
                                                                 v-html="form.errors.get('EmiAmount')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4" v-if="IsEmiEnable">
                                                    <ValidationProvider name="InterestRate" mode="eager"
                                                                        rules="required" v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Interest Rate</label>
                                                            <input type="number" class="form-control"
                                                                   name="InterestRate" readonly
                                                                   v-model="form.InterestRate">
                                                            <div class="error" v-if="form.errors.has('InterestRate')"
                                                                 v-html="form.errors.get('InterestRate')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4" v-if="IsEmiEnable">
                                                    <ValidationProvider name="InterestPayable" mode="eager"
                                                                        rules="required" v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Interest Payable</label>
                                                            <input type="number" class="form-control"
                                                                   name="InterestPayable" readonly
                                                                   v-model="form.InterestPayable">
                                                            <div class="error" v-if="form.errors.has('InterestPayable')"
                                                                 v-html="form.errors.get('InterestPayable')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="row form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 160px">Reference</p>
                                                </div>

                                                <div class="col-6 col-md-4">
                                                    <ValidationProvider name="SalesStaffName" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Sales Staff Name</label>
                                                            <input type="text" class="form-control"
                                                                   name="SalesStaffName" v-model="form.SalesStaffName">
                                                            <div class="error" v-if="form.errors.has('SalesStaffName')"
                                                                 v-html="form.errors.get('SalesStaffName')"/>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4">
                                                    <ValidationProvider name="SalesStaffDesignation" mode="eager"
                                                                        rules="" v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Sales Staff Designation</label>
                                                            <input type="text" class="form-control"
                                                                   name="SalesStaffDesignation"
                                                                   v-model="form.SalesStaffDesignation">
                                                            <div class="error"
                                                                 v-if="form.errors.has('SalesStaffDesignation')"
                                                                 v-html="form.errors.get('SalesStaffDesignation')"/>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-4">
                                                    <ValidationProvider name="MechanicsCode" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Local Mechanics</label>
                                                            <select name="MechanicsCode" class="form-control"
                                                                    v-model="form.MechanicsCode">
                                                                <option :value="mechanic.MechanicsCode"
                                                                        v-for="(mechanic , index) in mechanics"
                                                                        :key="index">{{ mechanic.UpazillaName }} -
                                                                    {{ mechanic.MechanicsName }}
                                                                </option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('MechanicsCode')"
                                                                 v-html="form.errors.get('MechanicsCode')"/>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="row form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 160px">Exchange</p>
                                                </div>

                                                <div class="col-12 col-md-2">
                                                    <ValidationProvider name="IsExchange" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Exchange?</label>
                                                            <select name="IsExchange" class="form-control"
                                                                    v-model="form.IsExchange"
                                                                    @change="changeIsExchange">
                                                                <option value="0">No</option>
                                                                <option value="1">Yes</option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('IsExchange')"
                                                                 v-html="form.errors.get('IsExchange')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="ExchangeBrand" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Exchange Brand</label>
                                                            <select name="ExchangeBrand" class="form-control"
                                                                    v-model="form.ExchangeBrand">
                                                                <option :value="brand.BrandCode"
                                                                        v-for="(brand , index) in exchange_brand"
                                                                        :key="index">{{ brand.BrandName }}
                                                                </option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('ExchangeBrand')"
                                                                 v-html="form.errors.get('ExchangeBrand')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="ExchangeEngineNo" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Engine No</label>
                                                            <input type="text" class="form-control"
                                                                   name="ExchangeEngineNo"
                                                                   v-model="form.ExchangeEngineNo">
                                                            <div class="error"
                                                                 v-if="form.errors.has('ExchangeEngineNo')"
                                                                 v-html="form.errors.get('ExchangeEngineNo')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="ExchangeChassisNo" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Chassis No</label>
                                                            <input type="text" class="form-control"
                                                                   name="ExchangeChassisNo"
                                                                   v-model="form.ExchangeChassisNo">
                                                            <div class="error"
                                                                 v-if="form.errors.has('ExchangeChassisNo')"
                                                                 v-html="form.errors.get('ExchangeChassisNo')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="BrandName" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Old Bike Brand</label>
                                                            <select name="BrandName" class="form-control"
                                                                    v-model="form.BrandName"
                                                                    @change="getAllOldBikeModel">
                                                                <option :value="brand.BrandName"
                                                                        v-for="(brand , index) in OldBikeBrand"
                                                                        :key="index">{{ brand.BrandName }}
                                                                </option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('BrandName')"
                                                                 v-html="form.errors.get('BrandName')"/>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-6 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="ModelName" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Old Bike Model</label>
                                                            <select name="ModelName" class="form-control"
                                                                    v-model="form.ModelName">
                                                                <option :value="model.ModelName"
                                                                        v-for="(model , index) in OldBikeModel"
                                                                        :key="index">{{ model.ModelName }}
                                                                </option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('ModelName')"
                                                                 v-html="form.errors.get('ModelName')"/>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <!--                        <div class="col-12 col-md-2" v-if="IsExchangeEnable">-->
                                                <!--                          <ValidationProvider name="OldBikeModel" mode="eager" rules="" v-slot="{ errors }">-->
                                                <!--                            <div class="form-group">-->
                                                <!--                              <label>Old Bike Model</label>-->
                                                <!--                              <input type="text" class="form-control" name="OldBikeModel" v-model="form.OldBikeModel">-->
                                                <!--                              <div class="error" v-if="form.errors.has('OldBikeModel')" v-html="form.errors.get('OldBikeModel')" />-->
                                                <!--                              <span class="error-message"> {{ errors[0] }}</span>-->
                                                <!--                            </div>-->
                                                <!--                          </ValidationProvider>-->
                                                <!--                        </div>-->
                                                <div class="col-12 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="OldBikePrice" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Old Bike Price</label>
                                                            <input type="number" class="form-control"
                                                                   name="OldBikePrice" v-model="form.OldBikePrice">
                                                            <div class="error" v-if="form.errors.has('OldBikePrice')"
                                                                 v-html="form.errors.get('OldBikePrice')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeEnable">
                                                    <ValidationProvider name="ExchangeMedium" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Exchange Medium</label>
                                                            <select name="ExchangeMedium" class="form-control"
                                                                    v-model="form.ExchangeMedium"
                                                                    @change="exchangeMediumEnable">
                                                                <option value="dealer">Dealer</option>
                                                                <option value="reseller">Reseller</option>
                                                            </select>
                                                            <div class="error" v-if="form.errors.has('ExchangeMedium')"
                                                                 v-html="form.errors.get('ExchangeMedium')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeMediumEnable">
                                                    <ValidationProvider name="ExchangeCustomerDiscount" mode="eager"
                                                                        rules="" v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Exchange Customer Discount</label>
                                                            <input type="number" class="form-control"
                                                                   name="ExchangeCustomerDiscount"
                                                                   v-model="form.ExchangeCustomerDiscount">
                                                            <div class="error"
                                                                 v-if="form.errors.has('ExchangeCustomerDiscount')"
                                                                 v-html="form.errors.get('ExchangeCustomerDiscount')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeMediumEnable">
                                                    <ValidationProvider name="ResellerName" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Reseller Name</label>
                                                            <input type="text" class="form-control" name="ResellerName"
                                                                   v-model="form.ResellerName">
                                                            <div class="error" v-if="form.errors.has('ResellerName')"
                                                                 v-html="form.errors.get('ResellerName')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeMediumEnable">
                                                    <ValidationProvider name="ResellerContact" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Reseller Contact</label>
                                                            <input type="text" class="form-control"
                                                                   name="ResellerContact"
                                                                   v-model="form.ResellerContact">
                                                            <div class="error" v-if="form.errors.has('ResellerContact')"
                                                                 v-html="form.errors.get('ResellerContact')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-12 col-md-2" v-if="IsExchangeMediumEnable">
                                                    <ValidationProvider name="ResellerCommission" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group">
                                                            <label>Reseller Commission(%)</label>
                                                            <input type="text" class="form-control"
                                                                   name="ResellerCommission"
                                                                   v-model="form.ResellerCommission">
                                                            <div class="error"
                                                                 v-if="form.errors.has('ResellerCommission')"
                                                                 v-html="form.errors.get('ResellerCommission')"/>
                                                            <span class="error-message"> {{ errors[0] }}</span>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>

                                    <div class="row">
                                        <div class="col-md-5">
                                            <div class="row form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 120px">Payment</p>
                                                </div>
                                                <div class="col-md-12">
                                                    <ValidationProvider name="TotalPayable" mode="eager"
                                                                        rules="required" v-slot="{ errors }">
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <label class="col-lg-4 col-form-label text-center">Total
                                                                Payable</label>
                                                            <div class="col-lg-7">
                                                                <input name="TotalPayable" type="text"
                                                                       class="form-control" readonly
                                                                       v-model="form.TotalPayable"/>
                                                                <div class="error"
                                                                     v-if="form.errors.has('TotalPayable')"
                                                                     v-html="form.errors.get('TotalPayable')"/>
                                                                <span class="error-message"> {{ errors[0] }}</span>
                                                            </div>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-md-12">
                                                    <ValidationProvider name="CashAmount" mode="eager" rules="required"
                                                                        v-slot="{ errors }">
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <div class="col-lg-4 col-form-label text-center">
                                                                <div class="form-check">
                                                                    <input type="checkbox" class="form-check-input"
                                                                           id="cash" value="cash"
                                                                           v-model="form.cashSelected"
                                                                           @change="cashEnableDisable">
                                                                    <label class="form-check-label"
                                                                           for="cash">Cash</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-7">
                                                                <input name="CashAmount" type="text" id="CashAmount"
                                                                       class="form-control" v-model="form.CashAmount"
                                                                       :disabled="!form.cashSelected"
                                                                       @keyup="enterCashAmount"/>
                                                                <div class="error" v-if="form.errors.has('CashAmount')"
                                                                     v-html="form.errors.get('CashAmount')"/>
                                                                <span class="error-message"> {{ errors[0] }}</span>
                                                            </div>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <div class="col-md-12">
                                                    <ValidationProvider name="TotalPayable" mode="eager"
                                                                        rules="required" v-slot="{ errors }">
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <div class="col-lg-4 col-form-label text-center">
                                                                <div class="form-check">
                                                                    <input type="checkbox" class="form-check-input"
                                                                           id="card" value="card"
                                                                           v-model="form.cardSelected"
                                                                           @change="cardEnableDisable">
                                                                    <label class="form-check-label"
                                                                           for="card">Card</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-7">
                                                                <input name="TotalCardAmount" type="text"
                                                                       class="form-control"
                                                                       v-model="form.TotalCardAmount" :disabled="true"/>
                                                            </div>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>

                                            </div>
                                        </div>
                                        <div class="col-md-7">
                                            <div class="row form-divider m-b-15">
                                                <div class="form-divider-title">
                                                    <p style="width: 100px">Bank</p>
                                                </div>

                                                <div class="col-md-12" v-for="(tender, i) in tender_type"
                                                     :key="tender.TenderId" v-if="tender_type.length">
                                                    <ValidationProvider name="SwipRate" mode="eager" rules=""
                                                                        v-slot="{ errors }">
                                                        <div class="form-group row" style="padding-bottom: 10px">
                                                            <div class="col-lg-3 col-form-label">
                                                                <div class="form-check">
                                                                    <input type="checkbox" class="form-check-input"
                                                                           name="TenderTypeSelect[]" :id="`Tend${i}`"
                                                                           :disabled="!form.cardSelected"
                                                                           :value="tender.TenderId"
                                                                           v-model="form.TenderTypeSelect"
                                                                           @change="TenderTypeSelect($event,`TenderTypeSelect${i}`, i, tender.TenderId)">
                                                                    <label class="form-check-label" :for="`Tend${i}`">{{
                                                                        tender.TenderType
                                                                        }}</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-4">
                                                                <input name="CardAmount" type="text"
                                                                       class="form-control"
                                                                       @keyup="TenderAmountSelect(tender)"
                                                                       :id="`TenderTypeSelect${i}`" readonly=""
                                                                       v-model="tender.CardAmount"/>
                                                                <div class="error" v-if="form.errors.has('CardAmount')"
                                                                     v-html="form.errors.get('CardAmount')"/>
                                                                <span class="error-message"> {{ errors[0] }}</span>
                                                            </div>
                                                            <label class="col-lg-2 col-form-label">Swipe Rate</label>
                                                            <div class="col-lg-3">
                                                                <input type="number" name="SwipRate"
                                                                       class="form-control" :id="`SwipRate${i}`"
                                                                       :disabled="true" :value="tender.SwipeCharge"/>
                                                                <div class="error" v-if="form.errors.has('SwipRate')"
                                                                     v-html="form.errors.get('SwipRate')"/>
                                                                <span class="error-message"> {{ errors[0] }}</span>
                                                            </div>
                                                        </div>
                                                    </ValidationProvider>
                                                </div>
                                                <hr>
                                                <table class="table">
                                                    <tr>
                                                        <td>Total</td>
                                                        <td><input type="text" name="TotalAmount" id="TotalAmount"
                                                                   :value="form.TotalAmount" class="form-control"
                                                                   readonly=""></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    <button type="submit" class="btn btn-primary float-right submit_on_enter">Submit
                                    </button>
                                </form>
                            </ValidationObserver>
                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <loader v-if="PreLoader" object="#ff9633" color1="#ffffff" color2="#17fd3d" size="5" speed="2" bg="#343a40"
                    objectbg="#999793" opacity="80" name="circular"></loader>
        </div>
    </div>
</template>

<script>
import {baseurl} from '../../base_url'
import {Common} from "../../mixins/common";
import moment from "moment";
import DatePicker from 'vue2-datepicker';
import 'vue2-datepicker/index.css';

export default {
    name: "Invoice",
    mixins: [Common],
    components: {DatePicker},
    data() {
        return {
            businesses: [],
            districts: [],
            occupations: [],
            thanas: [],
            monthly_income: [],
            productIntroducingMedias: [],
            interestInProduct: [],
            previouslyUsedBike: [],
            previousBikeCC: [],
            previousBikeUsage: [],
            causeForBuyingNewBike: [],
            emi_installment: [],
            emi_bank: [],
            mechanics: [],
            exchange_brand: [],
            tender_type: [],
            AllChassisNo: [],
            OldBikeBrand: [],
            OldBikeModel: [],
            pagination: {
                current_page: 1,
                from: 1,
                to: 1,
                total: 1,
            },
            bloodGroups: [
                'A+',
                'A-',
                'B+',
                'B-',
                'O+',
                'O-',
                'AB+',
                'AB-'
            ], // List of blood groups
            form: new Form({
                ChassisNo: '',
                EngineNo: '',
                ProductCode: '',
                Model: '',
                Color: '',
                Price: '',
                Discount: 0,
                SalesType: 'cash',
                CreditAmount: 0,
                Tenure: 0,
                CustomerName: '',
                Gender: 'Male',
                FatherName: '',
                Address: '',
                PermanentAddress: '',
                DistrictCode: '',
                Email: '',
                InquirySale: '0',
                REisKnown: 'yes',
                DateOfBirth: moment().format('yyyy-MM-DD'),
                CustomerOccupation: '',
                OwnerTyp: 'Private',
                MotherName: '',
                Mobile: '',
                EmergencyMobile: '',
                ThanaCode: '',
                bloodGroup: '',
                NID: '',
                Photo: '',
                MonthlyIncome: '',
                productIntroducingMedias: [],
                interestInProduct: [],
                previouslyUsedBike: [],
                previousBikeCC: '',
                previousBikeUsage: '',
                causeForBuyingNewBike: '',
                wantJoinRE: '',
                MarriageDay: '',
                IsEmi: 0,
                InstallmentSize: 0,
                EmiBank: 0,
                EmiAmount: 0,
                InterestRate: 0,
                InterestPayable: 0,
                SalesStaffName: '',
                SalesStaffDesignation: '',
                MechanicsCode: '',
                IsExchange: 0,
                ExchangeBrand: '',
                ExchangeEngineNo: '',
                ExchangeChassisNo: '',
                //OldBikeModel : '',
                BrandName: '',
                ModelName: '',
                OldBikePrice: 0,
                ExchangeMedium: '',
                ExchangeCustomerDiscount: 0,
                ResellerName: '',
                ResellerContact: '',
                ResellerCommission: 0,
                TotalPayable: '',
                TotalPayableWithDiscount: '',
                cashSelected: false,
                TotalCardAmount: 0,
                CashAmount: 0,
                cardSelected: false,
                TenderTypeSelect: [],
                tenderSelected: [],
                //CardAmount : [],
                SwipRate: [],
                TotalAmount: 0,
            }),
            errors: [],
            isLoading: false,
            buttonShow: false,
            CreditFieldEnable: false,
            IsEmiEnable: false,
            IsExchangeEnable: false,
            IsExchangeMediumEnable: false,
            PreLoader: false,
        }
    },
    created() {
        //
    },
    computed: {
        //
    },
    mounted() {
        document.title = 'Invoice Create | DMS';
        this.getAllDistrict();
        this.getAllOccupations();
        this.getAllMonthlyIncome();
        this.getAllProductIntroducingMedias();
        this.getAllInterestInProduct();
        this.getAllPreviouslyUsedBike();
        this.getAllPreviousBikeCC();
        this.getAllPreviousBikeUsage();
        this.getAllCauseForBuyingNewBike();
        this.getAllEmiInstallment();
        this.getAllEmiBank();
        this.getAllMechanics();
        this.getAllExchangeBrand();
        this.getAllTenderType();
        this.getAllOldBikeBrand();
    },
    methods: {
        onSubmit() {
            this.PreLoader = true;
            if (this.form.IsEmi == 1) {
                let EmiAmount = parseInt(this.form.EmiAmount);
                if (isNaN(EmiAmount)) {
                    EmiAmount = 0
                }
                let UnitPrice = this.form.Price;
                if (isNaN(UnitPrice)) {
                    UnitPrice = 0
                }
                if (EmiAmount > (UnitPrice / 2)) {
                    let HalfAmount = UnitPrice / 2;
                    Swal.fire({
                        icon: "error",
                        title: "Oops...",
                        text: "EMI Amount can\'t be more then " + HalfAmount,
                    });
                }
            }

            let TotalPayable = this.form.TotalPayable;
            if (isNaN(TotalPayable)) {
                TotalPayable = 0;
            }
            let TotalAmount = this.form.TotalAmount;
            if (isNaN(TotalAmount)) {
                TotalAmount = 0;
            }
            if (TotalPayable != TotalAmount) {
                Swal.fire({
                    icon: "error",
                    title: "Oops...",
                    text: "Total Amount and Total Payable Amount Are Not Same",
                });
            }
            this.form.post(baseurl + "api/invoice-create", this.config()).then(response => {
                if (response.data.status === 'success') {
                    this.$toaster.success(response.data.message);
                    this.$router.go(this.$router.currentRoute)
                } else {
                    this.$toaster.error(response.data.message);
                }
                this.PreLoader = false;
            }).catch(e => {
                this.PreLoader = false;
                this.$toaster.error(e.data.message);
            });
        },
        filterChassisNo(val) {
            this.form.ChassisNo = val;
            this.form.post(baseurl + "api/filter-chassis", this.config()).then(response => {
                if (response.data.status === 'success') {
                    this.AllChassisNo = response.data.chassis_info
                } else {
                    //
                }
            }).catch(e => {
                this.$toaster.error(response.data.message);
            });
        },
        doCheckChassisNo() {
            this.form.post(baseurl + "api/check-chassis", this.config()).then(response => {
                if (response.data.status === 'success') {
                    this.$toaster.success(response.data.message);
                    this.form.EngineNo = response.data.chassis_info.EngineNo
                    this.form.ProductCode = response.data.chassis_info.ProductCode
                    this.form.Model = response.data.chassis_info.ProductName
                    this.form.Color = response.data.chassis_info.Color
                    this.form.Price = parseInt(response.data.chassis_info.UnitPrice)
                    this.form.TotalPayable = parseInt(response.data.chassis_info.UnitPrice)
                } else {
                    this.form.EngineNo = ''
                    this.form.ProductCode = ''
                    this.form.Model = ''
                    this.form.Color = ''
                    this.form.Price = ''
                    this.$toaster.error(response.data.message);
                }
            }).catch(e => {
                this.$toaster.error(e.data.message);
            });
        },
        setDiscount() {
            this.form.TotalPayable = this.form.Price - this.form.Discount;
            let totalInterestPayable = this.form.InterestPayable;
            if (totalInterestPayable > 0) {
                this.form.TotalPayable = (this.form.Price + this.form.InterestPayable) - this.form.Discount;
            } else {
                this.form.TotalPayable = this.form.Price - this.form.Discount;
            }
        },
        getAllDistrict() {
            axios.get(baseurl + 'api/get-all-district', this.config()).then((response) => {
                this.districts = response.data.districts;
            }).catch((error) => {

            })
        },
        getAllOccupations() {
            axios.get(baseurl + 'api/get-all-occupations', this.config()).then((response) => {
                this.occupations = response.data.occupations;
            }).catch((error) => {

            })
        },
        districtWiseThana() {
            axios.get(baseurl + 'api/district-wise-thana?DistrictCode=' + this.form.DistrictCode, this.config()).then((response) => {
                this.thanas = response.data.thanas
            }).catch((error) => {

            })
        },
        changeSalesType() {
            if (this.form.SalesType === 'credit') {
                this.CreditFieldEnable = true;
            } else {
                this.CreditFieldEnable = false;
            }
        },
        getAllMonthlyIncome() {
            axios.get(baseurl + 'api/get-all-monthly-income', this.config()).then((response) => {
                this.monthly_income = response.data.monthly_income;
            }).catch((error) => {

            })
        },
        getAllProductIntroducingMedias() {
            axios.get(baseurl + 'api/get-all-product-introducing-medias', this.config()).then((response) => {
                this.productIntroducingMedias = response.data.productIntroducingMedias;
            }).catch((error) => {

            })
        },
        getAllInterestInProduct() {
            axios.get(baseurl + 'api/get-all-interest-in-product', this.config()).then((response) => {
                this.interestInProduct = response.data.interestInProduct;
            }).catch((error) => {

            })
        },
        getAllPreviouslyUsedBike() {
            axios.get(baseurl + 'api/get-all-previously-used-bike', this.config()).then((response) => {
                this.previouslyUsedBike = response.data.previouslyUsedBike;
            }).catch((error) => {

            })
        },
        getAllPreviousBikeCC() {
            axios.get(baseurl + 'api/get-all-previous-bike-cc', this.config()).then((response) => {
                this.previousBikeCC = response.data.previousBikeCC;
            }).catch((error) => {

            })
        },
        getAllPreviousBikeUsage() {
            axios.get(baseurl + 'api/get-all-previous-bike-usage', this.config()).then((response) => {
                this.previousBikeUsage = response.data.previousBikeUsage;
            }).catch((error) => {

            })
        },
        getAllCauseForBuyingNewBike() {
            axios.get(baseurl + 'api/get-all-cause-for-buying-new-bike', this.config()).then((response) => {
                this.causeForBuyingNewBike = response.data.causeForBuyingNewBike;
            }).catch((error) => {

            })
        },
        getAllEmiInstallment() {
            axios.get(baseurl + 'api/get-all-emi-installment', this.config()).then((response) => {
                this.emi_installment = response.data.emi_installment;
            }).catch((error) => {

            })
        },
        getAllEmiBank() {
            axios.get(baseurl + 'api/get-all-emi-bank', this.config()).then((response) => {
                this.emi_bank = response.data.emi_bank;
            }).catch((error) => {

            })
        },
        getAllMechanics() {
            axios.get(baseurl + 'api/get-all-mechanics', this.config()).then((response) => {
                this.mechanics = response.data.mechanics;
            }).catch((error) => {

            })
        },
        getAllTenderType() {
            axios.get(baseurl + 'api/get-all-tender-type', this.config()).then((response) => {
                this.tender_type = response.data.tender_type;
            }).catch((error) => {

            })
        },
        getAllOldBikeBrand() {
            axios.get(baseurl + 'api/get-all-old-bike-brand', this.config()).then((response) => {
                this.OldBikeBrand = response.data.brands;
            }).catch((error) => {

            })
        },
        getAllOldBikeModel() {
            axios.get(baseurl + 'api/get-all-old-bike-model?BrandName=' + this.form.BrandName, this.config()).then((response) => {
                this.OldBikeModel = response.data.models;
            }).catch((error) => {

            })
        },
        getAllExchangeBrand() {
            axios.get(baseurl + 'api/get-all-exchange-brand', this.config()).then((response) => {
                this.exchange_brand = response.data.exchange_brand;
            }).catch((error) => {

            })
        },
        calculatePayableInterest() {
            axios.post(baseurl + 'api/calculate-payable-interest/', {
                EmiBank: this.form.EmiBank,
                EmiAmount: this.form.EmiAmount,
                InstallmentSize: this.form.InstallmentSize,
            }, this.config()).then((response) => {
                this.form.InterestRate = response.data.data.InterestRate;
                this.form.InterestPayable = parseInt(response.data.data.Interest);

                let totalInterestPayable = this.form.InterestPayable;
                if (totalInterestPayable > 0) {
                    this.form.TotalPayable = (this.form.Price + this.form.InterestPayable) - this.form.Discount;
                } else {
                    this.form.TotalPayable = this.form.Price - this.form.Discount;
                }
            }).catch((error) => {

            })
        },
        TenderTypeSelect(e, inputid, index, TenderId) {
            let currentstatus = document.getElementById(inputid).readOnly;
            if (currentstatus == false) {
                document.getElementById(inputid).readOnly = true;
                document.getElementById(inputid).value = 0;
                //this.form.tenderSelected[index].CardAmount = 0

                this.form.tenderSelected.forEach(function (item) {
                    if (item.TenderId === TenderId) {
                        item.CardAmount = 0;
                    }
                });

                this.form.TotalAmount = 0;
                this.form.TotalCardAmount = this.sum();
                this.form.TotalAmount = this.sumTotal();
            } else {
                document.getElementById(inputid).readOnly = false;
            }
            this.form.tenderSelected = this.form.TenderTypeSelect.map(TenderId =>
                this.tender_type.find(tender => tender.TenderId === TenderId)
            )
        },
        TenderAmountSelect() {
            this.form.TotalAmount = 0;
            this.form.TotalCardAmount = this.sum();
            this.form.TotalAmount = this.sumTotal();
        },
        sum() {
            let total = this.form.tenderSelected.reduce((acc, item) => acc + parseInt(item.CardAmount), 0);
            let grandTotal = parseInt(this.form.TotalAmount) + parseInt(total);
            return parseInt(grandTotal);
        },
        sumTotal() {
            let total = this.form.tenderSelected.reduce((acc, item) => acc + parseInt(item.CardAmount), 0);
            let grandTotal = parseInt(this.form.TotalAmount) + parseInt(total) + parseInt(this.form.CashAmount);
            return parseInt(grandTotal);
        },
        cardEnableDisable() {
            if (this.form.cardSelected == false) {
                this.form.TotalAmount = parseInt(this.form.TotalCardAmount) + parseInt(this.form.CashAmount);
                this.tender_type.forEach(item => {
                    item.CardAmount = 0;
                });
                let inputs = document.getElementsByName('TenderTypeSelect[]');
                for (let i = 0; i < inputs.length; i++) {
                    inputs[i].checked = false;
                }
            }
        },
        cashEnableDisable() {
            if (this.form.cashSelected == false) {
                this.form.CashAmount = 0;
                this.form.TotalAmount = parseInt(this.form.TotalCardAmount) + parseInt(this.form.CashAmount);
            }
        },
        enterCashAmount() {
            this.form.TotalAmount = parseInt(this.form.TotalCardAmount) + parseInt(this.form.CashAmount);
        },
        changeIsEmi() {
            if (this.form.IsEmi == 1) {
                this.IsEmiEnable = true;
            } else {
                this.form.InstallmentSize = 0;
                this.form.EmiBank = 0;
                this.form.EmiAmount = 0;
                this.form.InterestRate = 0;
                this.form.InterestPayable = 0;
                this.form.TotalPayable = (this.form.Price - this.form.InterestPayable) - this.form.Discount;
                this.IsEmiEnable = false;
            }
        },
        changeIsExchange() {
            if (this.form.IsExchange == 1) {
                this.IsExchangeEnable = true;
            } else {
                this.IsExchangeEnable = false;
            }
        },
        exchangeMediumEnable() {
            if (this.form.ExchangeMedium === 'reseller') {
                this.IsExchangeMediumEnable = true;
            } else {
                this.IsExchangeMediumEnable = false;
            }
        },
        changeImage(event) {
            let file = event.target.files[0];
            let reader = new FileReader();
            reader.onload = event => {
                this.form.Photo = event.target.result;
            };
            reader.readAsDataURL(file);
        },
        showImage() {
            let img = this.form.Photo;
            if (img.length > 100) {
                return this.form.Photo;
            } else {
                //return window.location.origin + "/DEGS/generator/" + this.form.generator_image;
            }
        },
        validateEmergencyMobile(type) {
            const pattern = /^(01)?[0-9]{11}$/; // Regex for validation
            if(type.length>=11){
                let number =''
                if (type==='EmergencyMobile') {number= this.form.EmergencyMobile}
                else{number= this.form.Mobile }

            if (number && !pattern.test(this.form.number)) {
                this.$toaster.error('Invalid mobile number. Please enter a valid number.');
                if (type==='EmergencyMobile') {this.form.EmergencyMobile =''}
                else{this.form.Mobile='' }
            } else {
                this.emergencyMobileError = null; // Clear the error if valid
            }
        }
    },
        config() {
            let token = localStorage.getItem('token');
            return {
                headers: {Authorization: `Bearer ${token}`}
            };
        },
    }
}
</script>

<style scoped>
#customer_form .form-control {
    font-size: 10px;
    height: 29px;
}

#customer_form .form-group {
    margin-bottom: 0;
}

#customer_form label {
    font-size: 11px !important;
}

.form-divider {
    padding: 6px 5px 5px 5px;
    border: 1px solid #4d87f64f;
    border-radius: 13px;
    margin: 0 auto;
}

#invoice2 .auto-complete2 {
    position: relative;
    display: block;
}

#invoice2 .auto-complete2 ul {
    list-style: none;
    margin: 0;
    padding: 5px 0 0 0px;
    position: absolute;
    width: 100%;
    border: 1px solid #0000000d;
    background: #ffffff;
    max-height: 200px;
    overflow-y: scroll;
    z-index: 999;
}

#invoice2 .auto-complete2 ul li {
    border-bottom: 1px solid #b7b7b7;
    background: #cbc4c4;
    padding: 5px;
    cursor: pointer;
}

#invoice2 .auto-complete2 ul li a {
    color: #000000;
}

#invoice2 .auto-complete2 ul li:hover {
    background: #fff3cd;
}

#invoice2 :focus {
    background: #fff3cd;
}

.form-divider-title {
    position: relative;
    top: -20px;
}

.form-divider-title p {
    position: absolute;
    padding: 0 25px;
    background: #ffffff;
    text-transform: uppercase;
    font-weight: bold;
    color: #4d79f6b5 !important;
    font-size: 12px;
}

.tableFixHead {
    overflow-y: auto; /* make the table scrollable if height is more than 200 px  */
    height: 200px; /* gives an initial height of 200px to the table */
}

.tableFixHead thead th {
    position: sticky; /* make the table heads sticky */
    top: 0px; /* table head will be placed from the top of the table and sticks to it */
}

table {
    border-collapse: collapse; /* make the table borders collapse to each other */
    width: 100%;
}

th,
td {
    padding: 8px 16px;
    border: 1px solid #ccc;
}

th {
    background: #000000;
}
</style>